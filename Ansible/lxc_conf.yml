---
- name: Modfy LXC .conf
  hosts: pve_server
  tasks:
    - name: Add LXC configuration entries
      ansible.builtin.lineinfile:
        path: "/etc/pve/lxc/{{ id }}.conf"
        line: "{{ item }}"
        create: true
      loop: "{{ lxc_config }}"
      register: config_check
      notify: Restart LXC

  handlers:
    - name: Restart LXC
      ansible.builtin.command: pct reboot {{ id }}
      when: config_changes.changed
